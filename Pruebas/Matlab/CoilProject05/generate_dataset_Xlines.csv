% generate_one_row.m
addpath('C:/Users/Patriciagh/Documents/TFM/Pruebas/Matlab/CoilProject05');

coilName = 'bobinaL1';
coil     = getCoilType(coilName);
core     = getCoreType(coilName);

p1_min = 0.00075; p1_max = 0.002;
p2_min = 0.00075; p2_max = 0.002;
Lc_min = 0.001;   Lc_max = 0.003;

rng(42);  % semilla fija para reproducibilidad
numSamples = 20;

pitch1 = p1_min + (p1_max - p1_min)*rand();
pitch2 = p2_min + (p2_max - p2_min)*rand();
Lcore  = Lc_min + (Lc_max - Lc_min)*rand();

for i = 1:numSamples
    coil.pitch1 = pitch1;
    coil.pitch2 = pitch2;
    core.L      = Lcore;
    
    generic_coil_inductance
    Lpri = Inductance.Lpri;
    Lsec = Inductance.Lsec;
    L = Inductance.L;

    row = { ...
      coilName, ...
      coil.turns, ...
      coil.turns2, ...     % (si existe; si no, pon NaN o 0)
      coil.radius1, ...
      coil.radius2, ...
      coil.wd, ...
      pitch1, pitch2, ...
      Lcore, ...           % Longitud core
      Lpri, ...
      Lsec, ...
      L
    };
end

T = cell2table(row, 'VariableNames', {'coil_type', 'turns', 'turns2', 'r1', 'r2', 'wire_d', 'pitch1','pitch2','Lcore','Lpri', 'Lsec', 'L'});

writetable(T, 'coils_dataset_Xlines.csv');
disp('CSV generado: coils_dataset_Xlines.csv');
disp(T);
